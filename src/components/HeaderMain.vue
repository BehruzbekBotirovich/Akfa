<template>
    <header class="fixed top-0 left-0 z-20 bg-white w-full shadow-md">
        <div class="flex gap-10 py-2 main-container justify-between items-center">
            <div>
                <svg width="70" height="70" viewBox="0 0 284 241" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <line y1="-1.5" x2="208.344" y2="-1.5"
                        transform="matrix(0.938388 0.345583 -0.337147 0.941452 20.5797 85.5217)" stroke="#AF7D28"
                        stroke-width="3" />
                    <line opacity="0.8" x1="22.5797" y1="85.5217" x2="22.5797" y2="195.087" stroke="#AF7D28"
                        stroke-width="4" />
                    <line x1="20.5797" y1="196.217" x2="250.043" y2="196.217" stroke="#AF7D28" stroke-width="4" />
                    <line x1="250.102" y1="198.217" x2="250.102" y2="52.1304" stroke="#AF7D28" stroke-width="4" />
                    <line y1="-2" x2="191.154" y2="-2"
                        transform="matrix(-0.963562 0.267484 -0.260613 -0.965443 251.073 49)" stroke="#AF7D28"
                        stroke-width="4" />
                    <line y1="-2" x2="120.093" y2="-2"
                        transform="matrix(0.831121 0.556092 -0.545359 0.838202 86.4348 4.13043)" stroke="#AF7D28"
                        stroke-width="4" />
                    <line x1="189.275" y1="67.7826" x2="189.275" y2="195.087" stroke="#AF7D28" stroke-width="4" />
                    <line y1="-2" x2="94.9587" y2="-2"
                        transform="matrix(0.00852522 0.999964 -0.999962 0.00876704 66.884 101.174)" stroke="#AF7D28"
                        stroke-width="4" />
                    <line x1="215" y1="154.391" x2="215" y2="195.087" stroke="#AF7D28" stroke-width="4" />
                    <line x1="86.3768" y1="1" x2="86.3768" y2="197.174" stroke="#AF7D28" stroke-width="4" />
                    <path
                        d="M21.096 204.887H25.776V230.087H21.096V204.887ZM8.064 230.087H3.384V204.887H8.064V230.087ZM21.456 219.287H7.668V215.291H21.456V219.287ZM32.5285 230.087V204.887H37.2085V230.087H32.5285ZM42.6206 221.951V218.207H52.5206V221.951H42.6206ZM61.7226 230.087V208.847H53.3706V204.887H74.7546V208.847H66.4026V230.087H61.7226ZM82.5868 215.363H95.1148V219.215H82.5868V215.363ZM82.9468 226.163H97.1668V230.087H78.2668V204.887H96.6628V208.811H82.9468V226.163ZM114.048 230.447C112.128 230.447 110.34 230.135 108.684 229.511C107.052 228.863 105.624 227.963 104.4 226.811C103.2 225.635 102.264 224.255 101.592 222.671C100.92 221.087 100.584 219.359 100.584 217.487C100.584 215.615 100.92 213.887 101.592 212.303C102.264 210.719 103.212 209.351 104.436 208.199C105.66 207.023 107.088 206.123 108.72 205.499C110.352 204.851 112.14 204.527 114.084 204.527C116.148 204.527 118.032 204.887 119.736 205.607C121.44 206.303 122.88 207.347 124.056 208.739L121.032 211.583C120.12 210.599 119.1 209.867 117.972 209.387C116.844 208.883 115.62 208.631 114.3 208.631C112.98 208.631 111.768 208.847 110.664 209.279C109.584 209.711 108.636 210.323 107.82 211.115C107.028 211.907 106.404 212.843 105.948 213.923C105.516 215.003 105.3 216.191 105.3 217.487C105.3 218.783 105.516 219.971 105.948 221.051C106.404 222.131 107.028 223.067 107.82 223.859C108.636 224.651 109.584 225.263 110.664 225.695C111.768 226.127 112.98 226.343 114.3 226.343C115.62 226.343 116.844 226.103 117.972 225.623C119.1 225.119 120.12 224.363 121.032 223.355L124.056 226.235C122.88 227.603 121.44 228.647 119.736 229.367C118.032 230.087 116.136 230.447 114.048 230.447ZM146.252 204.887H150.932V230.087H146.252V204.887ZM133.22 230.087H128.54V204.887H133.22V230.087ZM146.612 219.287H132.824V215.291H146.612V219.287ZM169.457 230.447C167.489 230.447 165.677 230.135 164.021 229.511C162.389 228.863 160.961 227.963 159.737 226.811C158.513 225.635 157.565 224.255 156.893 222.671C156.221 221.087 155.885 219.359 155.885 217.487C155.885 215.615 156.221 213.887 156.893 212.303C157.565 210.719 158.513 209.351 159.737 208.199C160.985 207.023 162.437 206.123 164.093 205.499C165.749 204.851 167.561 204.527 169.529 204.527C171.665 204.527 173.585 204.875 175.289 205.571C177.017 206.267 178.469 207.287 179.645 208.631L176.693 211.511C175.709 210.527 174.641 209.807 173.489 209.351C172.361 208.871 171.113 208.631 169.745 208.631C168.425 208.631 167.201 208.847 166.073 209.279C164.945 209.711 163.973 210.323 163.157 211.115C162.341 211.907 161.705 212.843 161.249 213.923C160.817 215.003 160.601 216.191 160.601 217.487C160.601 218.759 160.817 219.935 161.249 221.015C161.705 222.095 162.341 223.043 163.157 223.859C163.973 224.651 164.933 225.263 166.037 225.695C167.141 226.127 168.365 226.343 169.709 226.343C170.957 226.343 172.157 226.151 173.309 225.767C174.485 225.359 175.601 224.687 176.657 223.751L179.321 227.243C178.001 228.299 176.465 229.103 174.713 229.655C172.985 230.183 171.233 230.447 169.457 230.447ZM174.893 226.631V217.199H179.321V227.243L174.893 226.631ZM185.493 230.087V204.887H190.173V226.127H203.349V230.087H185.493ZM203.515 230.087L214.855 204.887H219.463L230.839 230.087H225.943L216.187 207.371H218.059L208.339 230.087H203.515ZM208.735 224.255L209.995 220.583H223.603L224.863 224.255H208.735ZM241.856 230.447C239.888 230.447 238.004 230.171 236.204 229.619C234.404 229.043 232.976 228.311 231.92 227.423L233.54 223.787C234.548 224.579 235.796 225.239 237.284 225.767C238.772 226.295 240.296 226.559 241.856 226.559C243.176 226.559 244.244 226.415 245.06 226.127C245.876 225.839 246.476 225.455 246.86 224.975C247.244 224.471 247.436 223.907 247.436 223.283C247.436 222.515 247.16 221.903 246.608 221.447C246.056 220.967 245.336 220.595 244.448 220.331C243.584 220.043 242.612 219.779 241.532 219.539C240.476 219.299 239.408 219.023 238.328 218.711C237.272 218.375 236.3 217.955 235.412 217.451C234.548 216.923 233.84 216.227 233.288 215.363C232.736 214.499 232.46 213.395 232.46 212.051C232.46 210.683 232.82 209.435 233.54 208.307C234.284 207.155 235.4 206.243 236.888 205.571C238.4 204.875 240.308 204.527 242.612 204.527C244.124 204.527 245.624 204.719 247.112 205.103C248.6 205.487 249.896 206.039 251 206.759L249.524 210.395C248.396 209.723 247.232 209.231 246.032 208.919C244.832 208.583 243.68 208.415 242.576 208.415C241.28 208.415 240.224 208.571 239.408 208.883C238.616 209.195 238.028 209.603 237.644 210.107C237.284 210.611 237.104 211.187 237.104 211.835C237.104 212.603 237.368 213.227 237.896 213.707C238.448 214.163 239.156 214.523 240.02 214.787C240.908 215.051 241.892 215.315 242.972 215.579C244.052 215.819 245.12 216.095 246.176 216.407C247.256 216.719 248.228 217.127 249.092 217.631C249.98 218.135 250.688 218.819 251.216 219.683C251.768 220.547 252.044 221.639 252.044 222.959C252.044 224.303 251.672 225.551 250.928 226.703C250.208 227.831 249.092 228.743 247.58 229.439C246.068 230.111 244.16 230.447 241.856 230.447ZM264.497 230.447C262.529 230.447 260.645 230.171 258.845 229.619C257.045 229.043 255.617 228.311 254.561 227.423L256.181 223.787C257.189 224.579 258.437 225.239 259.925 225.767C261.413 226.295 262.937 226.559 264.497 226.559C265.817 226.559 266.885 226.415 267.701 226.127C268.517 225.839 269.117 225.455 269.501 224.975C269.885 224.471 270.077 223.907 270.077 223.283C270.077 222.515 269.801 221.903 269.249 221.447C268.697 220.967 267.977 220.595 267.089 220.331C266.225 220.043 265.253 219.779 264.173 219.539C263.117 219.299 262.049 219.023 260.969 218.711C259.913 218.375 258.941 217.955 258.053 217.451C257.189 216.923 256.481 216.227 255.929 215.363C255.377 214.499 255.101 213.395 255.101 212.051C255.101 210.683 255.461 209.435 256.181 208.307C256.925 207.155 258.041 206.243 259.529 205.571C261.041 204.875 262.949 204.527 265.253 204.527C266.765 204.527 268.265 204.719 269.753 205.103C271.241 205.487 272.537 206.039 273.641 206.759L272.165 210.395C271.037 209.723 269.873 209.231 268.673 208.919C267.473 208.583 266.321 208.415 265.217 208.415C263.921 208.415 262.865 208.571 262.049 208.883C261.257 209.195 260.669 209.603 260.285 210.107C259.925 210.611 259.745 211.187 259.745 211.835C259.745 212.603 260.009 213.227 260.537 213.707C261.089 214.163 261.797 214.523 262.661 214.787C263.549 215.051 264.533 215.315 265.613 215.579C266.693 215.819 267.761 216.095 268.817 216.407C269.897 216.719 270.869 217.127 271.733 217.631C272.621 218.135 273.329 218.819 273.857 219.683C274.409 220.547 274.685 221.639 274.685 222.959C274.685 224.303 274.313 225.551 273.569 226.703C272.849 227.831 271.733 228.743 270.221 229.439C268.709 230.111 266.801 230.447 264.497 230.447Z"
                        fill="black" />
                </svg>
            </div>

            <!-- Desktop Menu -->
            <a-menu mode="horizontal" class="items-center hidden lg:block h-fit" style="width: 400px;">
                <!-- Menu items go here -->
                <a-menu-item :class="{ activeItem: activeSection === 'about-us' }" key="1">
                    <a @click.prevent="scrollTo('about-us')" href="#">Услуги</a>
                </a-menu-item>
                <a-menu-item :class="{ activeItem: activeSection === 'product' }" key="2">
                    <a @click.prevent="scrollTo('product')" href="#">Продукция</a>
                </a-menu-item>
                <a-menu-item :class="{ activeItem: activeSection === 'workings' }" key="3">
                    <a @click.prevent="scrollTo('workings')" href="#">О компании</a>
                </a-menu-item>
                <a-menu-item :class="{ activeItem: activeSection === 'contact' }" key="5">
                    <a @click.prevent="scrollTo('contact')" href="#">Контакты</a>
                </a-menu-item>

            </a-menu>

            <!-- Burger Icon for Mobile -->
            <div class="lg:hidden">
                <a-button type="ghost" @click="showMobileMenu = !showMobileMenu" class="flex items-center text-xl">
                    <MenuUnfoldOutlined :class="showMobileMenu ? 'rotating' : 'inactive-class'" />
                </a-button>
            </div>

            <!-- Desktop buttons -->
            <div class="hidden lg:flex gap-4 w-fit">
                <a-button type="" @click="showModal"
                    class="flex items-center gap-2 h-10 rounded font-semibold text-white bg-orange-500">
                    <ZamerIcon></ZamerIcon> Оставить заявку
                </a-button>
            </div>
        </div>

        <!-- Mobile Menu -->
        <Transition name="slide-fade">
            <a-menu v-if="showMobileMenu" mode="vertical"
                class="lg:hidden fixed top-0 left-0 w-3/4 z-10 h-screen bg-white shadow-lg">
                <!-- Menu items go here -->

                <a-menu-item :class="{ active: activeSection === 'about-us' }" key="1">
                    <a @click.prevent="scrollTo('about-us')" href="#">Услуги</a>
                </a-menu-item>
                <a-menu-item :class="{ active: activeSection === 'product' }" key="2">
                    <a @click.prevent="scrollTo('product')" href="#">Продукция</a>
                </a-menu-item>
                <a-menu-item :class="{ active: activeSection === 'workings' }" key="3">
                    <a @click.prevent="scrollTo('workings')" href="#">О компании</a>
                </a-menu-item>
                <a-menu-item :class="{ active: activeSection === 'faq' }" key="4">
                    <a @click.prevent="scrollTo('faq')" href="#">Вопрос-ответ</a>
                </a-menu-item>
                <a-menu-item :class="{ active: activeSection === 'contact' }" key="5">
                    <a @click.prevent="scrollTo('contact')" href="#">Контакты</a>
                </a-menu-item>

            </a-menu>
        </Transition>

        <a-modal v-model:open="open" title="Вызвать замерщика на дом" @ok="handleOk" :footer="false">
            <ZamerWindow></ZamerWindow>
        </a-modal>
    </header>



</template>
<script setup>
import ZamerIcon from './icons/ZamerIcon.vue'
import ZamerWindow from './windows/ZamerWindow.vue'
import { ref, onMounted, onUnmounted } from 'vue';
import { MenuUnfoldOutlined, MenuFoldOutlined } from '@ant-design/icons-vue';
const activeSection = ref('');
const showMobileMenu = ref(false); // State to show/hide mobile menu

// moldalka ant vue
const open = ref(false);
const showModal = () => {
    open.value = true;
};
const handleOk = e => {
    console.log(e);
    open.value = false;
};

// menu boyicha navigatsiya scroll boyicha
const scrollTo = (elementId) => {
    const element = document.getElementById(elementId);
    showMobileMenu.value = false;
    if (element) {
        element.scrollIntoView({ behavior: 'smooth' });
        activeSection.value = elementId;
    }
};

const handleScroll = () => {
    const sections = ['about-us', 'product', 'workings', 'contact'];
    const scrollPosition = window.scrollY + window.innerHeight / 2;

    for (const section of sections) {
        const element = document.getElementById(section);
        if (element) {
            const { offsetTop, offsetHeight } = element;
            if (scrollPosition >= offsetTop && scrollPosition < offsetTop + offsetHeight) {
                activeSection.value = section;
                break;
            }
        }
    }
};

onMounted(() => {
    window.addEventListener('scroll', handleScroll);
    handleScroll(); // To set the active section on initial load
});

onUnmounted(() => {
    window.removeEventListener('scroll', handleScroll);
});
</script>
<style scoped>
.activeItem>span>a {
    color: blue;
    padding-bottom: 13px;
    border-bottom: 2px solid blue;
    transition: all 0.2s easy;
}


:deep(.ant-menu-horizontal) {
    border-bottom: none;
}

:deep(.ant-menu-item-selected) {
    color: black !important;

}

:deep(.ant-menu-item-selected::after) {
    display: none;
}

/* Transition for Mobile Menu */
.slide-fade-enter-active,
.slide-fade-leave-active {
    transition: transform 0.3s ease, opacity 0.3s ease;
}

.slide-fade-enter-from,
.slide-fade-leave-to {
    transform: translateX(-100%);
    opacity: 0;
}

.v-enter-active,
.v-leave-active {
    transition: opacity 0.5s ease;
}

.v-enter-from,
.v-leave-to {
    opacity: 0;
}

.rotating {
    transform: rotate(180deg);
}
</style>
